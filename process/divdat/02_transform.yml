- type: geocode
  table: ocp.divdat
  add_col: street
  geom_col: geom

- type: sql
  statements:
    - drop view if exists ocp.divdat_socrata;
    - create view ocp.divdat_socrata as
        ( select 
            name,
            street,
            city,
            state,
            zip, 
            case 
            when geom is null 
              then 'location (42.3314,-83.0458)'
              else concat(
                'location (',
                ST_Y(ST_Centroid(geom)), 
                ',', 
                ST_X(ST_Centroid(geom)),
                 ')'
              )
            end as location
          from ocp.divdat )
