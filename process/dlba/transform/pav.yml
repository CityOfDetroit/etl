- type: create_table
  table_name: pav_res
  as: select
        'Residential' as type,
        current_timestamp as posted_timestamp,
        c.address,
        c.parcel_id,
        c.demo_rfp_group as rfp_group,
        c.asb_abatement_verification_contractor_name as contractor,
        c.asb_post_abatement_passed_date,
        c.asb_post_abatement_verification_status,
        '' as public_access_url
      from dlba.case c

- type: create_table
  table_name: pav_comm
  as: select
        'Commercial' as type,
        current_timestamp as posted_timestamp,
        d.dba_com_property_name as address,
        d.dba_com_property_parcel_id as parcel_id,
        d.demo_rfp_number as rfp_group,
        d.asb_verification_contractor as contractor,
        d.asb_post_abatement_passed_date,
        d.asb_post_abatement_verification_status,
        '' as public_access_url
      from dlba.dba_commercial_demo d
      where d.dba_com_property_parcel_id is not null

- type: sql
  statements:
    - drop table if exists dlba.pav_all cascade;
    - create table dlba.pav_all as 
        select (type, address, parcel_id, rfp_group, contractor, asb_post_abatement_passed_date, asb_post_abatement_verification_status, public_access_url) from dlba.pav_res 
      union 
        select (type, address, parcel_id, rfp_group, contractor, asb_post_abatement_passed_date, asb_post_abatement_verification_status, public_access_url) from dlba.pav_comm;