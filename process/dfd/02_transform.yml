- type: geocode
  table: fire.dfd_locations
  add_col: address
  geom_col: geom

- type: sql
  statements:
    - drop view if exists fire.dfd_locations_socrata;
    - create view fire.dfd_locations_socrata as
        ( select 
            address, 
            engine,
            ladder,
            squad, 
            chief,
            medic,
            special,
            concat(
              'location (',
              ST_Y(ST_Centroid(geom)), 
              ',', 
              ST_X(ST_Centroid(geom)),
              ')'
            ) as location
          from fire.dfd_locations)